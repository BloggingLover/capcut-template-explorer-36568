═══════════════════════════════════════════════════════════════════════════
    📱 COMPLETE GUIDE: BUILD & TEST ANDROID APK WITH ADMOB ADS
═══════════════════════════════════════════════════════════════════════════

🔴 CRITICAL: READ THIS FIRST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
The 'server' section in capacitor.config.ts MUST be commented out for APK builds!
• If enabled: App will try to load from remote URL → CRASHES on device
• If disabled: App loads from local files → WORKS on device

✅ Current Status: Server section is COMMENTED OUT (ready for APK build)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


═══════════════════════════════════════════════════════════════════════════
PART 1️⃣: PREREQUISITES (ONE-TIME SETUP)
═══════════════════════════════════════════════════════════════════════════

📦 Required Software:
  ✓ Node.js (v16 or higher)
  ✓ Android Studio (for building APKs)
  ✓ Git (to clone/pull the project)

📥 Installation Steps:
  1. Download & install Android Studio from: https://developer.android.com/studio
  2. During setup, install Android SDK (required for building)
  3. Install Node.js from: https://nodejs.org/


═══════════════════════════════════════════════════════════════════════════
PART 2️⃣: BUILDING YOUR APK (STEP-BY-STEP)
═══════════════════════════════════════════════════════════════════════════

📂 Step 1: Clone/Pull the Project
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
git pull origin main
# Or if first time: git clone <your-repo-url>


📦 Step 2: Install Dependencies
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
npm install


🔧 Step 3: Verify Capacitor Config
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Open: capacitor.config.ts
Make sure the 'server' section is COMMENTED OUT like this:

  // server: {
  //   url: 'https://...',
  //   cleartext: true
  // },

⚠️ If NOT commented: APK will CRASH on device!


📱 Step 4: Add Android Platform (First Time Only)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
npx cap add android

Note: Skip this if you already have the 'android' folder


🏗️ Step 5: Build the Web App
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
npm run build

This creates the 'dist' folder with your compiled app


🔄 Step 6: Sync to Android
━━━━━━━━━━━━━━━━━━━━━━━
npx cap sync android

This copies your web app to Android project


📦 Step 7: Build the APK
━━━━━━━━━━━━━━━━━━━━━━
cd android
./gradlew assembleDebug

⏱️ Takes 1-2 minutes on first build
📁 APK Location: android/app/build/outputs/apk/debug/app-debug.apk


═══════════════════════════════════════════════════════════════════════════
PART 3️⃣: TESTING YOUR APK
═══════════════════════════════════════════════════════════════════════════

🤖 On Android Device/Emulator:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. Copy app-debug.apk to your phone (via USB/email/cloud)
2. Enable "Install from Unknown Sources" in phone settings
3. Tap the APK file to install
4. Open the app from app drawer

✅ Expected: App opens and loads templates
❌ If crashes: Check capacitor.config.ts server section is commented!


💻 On Android Studio:
━━━━━━━━━━━━━━━━━━━━━━━
1. Open Android Studio
2. File → Open → Select 'android' folder in project
3. Wait for Gradle sync to complete
4. Click green "Run" button (▶️) in toolbar
5. Select device/emulator from dropdown


═══════════════════════════════════════════════════════════════════════════
PART 4️⃣: TESTING ON WEB (VSCODE)
═══════════════════════════════════════════════════════════════════════════

🌐 Web Development Mode (No Ads):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
npm run dev

Then open: http://localhost:8080
Note: AdMob ads won't show on web (mobile-only)


═══════════════════════════════════════════════════════════════════════════
PART 5️⃣: UNDERSTANDING ADMOB ADS
═══════════════════════════════════════════════════════════════════════════

📁 Ad Code Location: src/services/admob.ts
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

This file contains:
  • AdMob initialization
  • Banner ad methods
  • Interstitial ad methods
  • Rewarded ad methods
  • Google Test Ad IDs


🎯 Where Ads Appear:
━━━━━━━━━━━━━━━━━━━━
1. 🏠 Home Page (src/pages/Home.tsx)
   • Banner ads appear after every 3-4 template cards
   • Line 114-118: Random banner insertion logic

2. 🔍 Search Page (src/pages/Search.tsx)
   • Interstitial ad shows when user searches (line 35)
   • Banner ads appear after every 3-4 results (line 117-121)

3. 📄 Template Detail (src/pages/TemplateDetail.tsx)
   • Rewarded ad: "Watch Ad to Unlock" button (line 143-158)
   • Native ad: Appears at bottom after all content (line 224)


🎮 Ad Components:
━━━━━━━━━━━━━━━━━
• src/components/BannerAd.tsx - Displays banner ads
• src/components/NativeAd.tsx - Displays native ads


🆔 Current Ad IDs (Google Test Ads):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Banner:       ca-app-pub-3940256099942544/6300978111
Interstitial: ca-app-pub-3940256099942544/1033173712
Rewarded:     ca-app-pub-3940256099942544/5224354917
Native:       ca-app-pub-3940256099942544/2247696110

⚠️ These are TEST ads - they work on devices but don't earn money!


💰 For Production (Real Ads):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. Create AdMob account: https://admob.google.com
2. Create ad units for your app
3. Replace test IDs in src/services/admob.ts with your real IDs
4. In capacitor.config.ts, change:
   initializeForTesting: false


═══════════════════════════════════════════════════════════════════════════
PART 6️⃣: TROUBLESHOOTING COMMON ISSUES
═══════════════════════════════════════════════════════════════════════════

❌ Problem: App crashes on device with "has a bug" error
✅ Solution: 
   • Open capacitor.config.ts
   • Make sure 'server' section is COMMENTED OUT
   • Rebuild: npm run build && npx cap sync android
   • Rebuild APK: cd android && ./gradlew assembleDebug


❌ Problem: Ads don't show on web browser
✅ Solution: 
   • This is NORMAL - AdMob only works on native mobile apps
   • Build APK and test on real device/emulator


❌ Problem: AGP version warning in Android Studio
✅ Solution:
   • This is just a warning, not critical
   • App will still build and run fine
   • If you want to fix: Update Android Studio to latest version


❌ Problem: "FAILURE: Build failed" error
✅ Solution:
   • Make sure Android Studio is installed
   • Run: cd android && ./gradlew clean
   • Then rebuild: ./gradlew assembleDebug


❌ Problem: Ads show "Ad failed to load"
✅ Solution:
   • On emulator: Make sure Google Play Services is installed
   • Test ads need internet connection
   • First ad load can take 5-10 seconds


═══════════════════════════════════════════════════════════════════════════
PART 7️⃣: QUICK REFERENCE COMMANDS
═══════════════════════════════════════════════════════════════════════════

Complete Build Sequence (After git pull):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
npm install
npm run build
npx cap sync android
cd android
./gradlew assembleDebug


Test on Emulator:
━━━━━━━━━━━━━━━━
npx cap run android


Web Development:
━━━━━━━━━━━━━━━━
npm run dev


Clean Build (if issues):
━━━━━━━━━━━━━━━━━━━━━━
cd android
./gradlew clean
./gradlew assembleDebug


═══════════════════════════════════════════════════════════════════════════
PART 8️⃣: DEVELOPMENT VS PRODUCTION CONFIG
═══════════════════════════════════════════════════════════════════════════

🔧 DEVELOPMENT MODE (Hot Reload in Android Studio):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
capacitor.config.ts - UNCOMMENT server section:
  server: {
    url: 'https://6be872e2-eea8-47c5-9592-a15bdaa575b7.lovableproject.com?forceHideBadge=true',
    cleartext: true
  },

Then: npx cap open android (run in Android Studio)
Benefit: Live reload, easier testing during development


📦 PRODUCTION MODE (APK Build):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
capacitor.config.ts - COMMENT OUT server section:
  // server: {
  //   url: '...',
  //   cleartext: true
  // },

Then: Build APK as described in Part 2
Benefit: App works offline, doesn't need internet to load


═══════════════════════════════════════════════════════════════════════════
📝 NOTES & TIPS
═══════════════════════════════════════════════════════════════════════════

✓ Cache System: Templates cached for 10 minutes for faster loading
✓ Back Button: Works correctly - navigates back or minimizes app
✓ Test Ads: Safe to use during development, just replace before publishing
✓ Build Time: First build takes ~2 minutes, subsequent builds ~30 seconds
✓ APK Size: Debug APK is ~20-30 MB

🔗 Useful Links:
  • Capacitor Docs: https://capacitorjs.com/docs
  • AdMob Integration: https://github.com/capacitor-community/admob
  • Android Build Guide: https://developer.android.com/studio/build


═══════════════════════════════════════════════════════════════════════════
Need Help? Common Questions:
═══════════════════════════════════════════════════════════════════════════

Q: Why don't I see ads on web?
A: AdMob only works on native mobile apps, not in web browsers.

Q: Can I test without building APK?
A: Yes, use Android Studio emulator: npx cap open android

Q: How to publish to Play Store?
A: Build release APK: ./gradlew assembleRelease (requires signing key)

Q: Is it safe to commit capacitor.config.ts with server commented?
A: Yes! This is the correct configuration for production APKs.

═══════════════════════════════════════════════════════════════════════════
